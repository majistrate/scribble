<?php

/**
 * @file
 * Provides an integration for the JQScribble library for Drupal.
 */

/**
 * Implements hook_menu().
 *
 * @return array
 */
function scribble_menu() {
  $items['scribble/blackboard'] = array(
    'title' => 'Scribble blackboard',
    'page callback' => 'drupal_get_form',
    'page arguments' => array('scribble_blackboard_form'),
    'access arguments' => array('access content'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'scribble.pages.inc',
  );
  $items['scribble/save'] = array(
    'page callback' => 'scribble_save_ajax',
    'access arguments' => array('access content'),
    'type' => MENU_NORMAL_ITEM,
    'file' => 'scribble.pages.inc',
  );
  /*
  $items['admin/config/user-interface/scribble'] = array(
    'title' => 'Example RSS feed',
    'page callback' => 'example_feed',
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
  );
  */

  return $items;
}

/*
 * Implements hook_library().
 */
function scribble_library() {
  $settings = array(
    'scribble' => array(
      'bgImagePath' => url(variable_get('scribble_files_directory', 'sites/default/files/scribble'), array('absolute' => TRUE)),
      'saveURL' => url('scribble/save', array('absolute' => TRUE)),
     ),
  );
  $libraries['jqscribble'] = array(
    'title' => t('JQScribble'),
    'website' => 'https://github.com/jimdoescode/jqScribble',
    'version' => '1.0',
    'js' => array(
      libraries_get_path('jqscribble') . '/jquery.jqscribble.js' => array(
        'type' => 'file',
      ),
      libraries_get_path('jqscribble') . '/jqscribble.extrabrushes.js' => array(
        'type' => 'file',
      ),
      drupal_get_path('module', 'scribble') . '/scribble.js' => array(
        'type' => 'file',
      ),
      array(
        'type' => 'setting',
        'data' => $settings,
      ),
    ),
    'css' => array(
      drupal_get_path('module', 'scribble') . '/theme/scribble.css' => array(
        'type' => 'file',
        'media' => 'screen',
      ),
    ),
  );
  return $libraries;
}

/**
 * Implements hook_theme().
 *
 * @param $existing
 * @param $type
 * @param $theme
 * @param $path
 * @return array
 */
function scribble_theme($existing, $type, $theme, $path) {
  return array(
    'scribble_blackboard' => array(
      'variables' => array(),
      'template' => 'scribble-blackboard',
      'path' => drupal_get_path('module', 'scribble') . '/theme',
    ),
  );
}
